from pwn import *

argv = ['a' for i in range(100)]
argv[65] = "\x00"
argv[66] = "\x20\x0a\x0d"
argv[67] = "12345" # port

env = {"\xde\xad\xbe\xef" : "\xca\xfe\xba\xbe"}

file = open("\x0a", "w")
file.write("\x00\x00\x00\x00")
file.close()

p = process(executable='/home/input2/input', argv=argv, env=env)
p.recvuntil(":)\n")
print(p.recvuntil("clear!\n"))

p.send("\x00\x0a\x00\xff")
error_data = b'\x00\x0a\x02\xff'
p.proc.stderr.write(error_data)

print(p.recvuntil("clear!\n"))
print(p.recvuntil("clear!\n"))
print(p.recvuntil("clear!\n"))

r = remote('127.0.0.1', 12345)
sleep(3)
r.send("\xde\xad\xbe\xef")
sleep(2)

print(p.recvuntil("clear!\n"))

p.interactive()
